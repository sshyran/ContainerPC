Parts from:

- https://gist.github.com/endophage/a514c2631ccc5f6ebb575232e7063622